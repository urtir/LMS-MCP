INFO:src.api.wazuh_fastmcp_server:CAG (transformers/torch) imports successful
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:src.api.wazuh_fastmcp_server:Semantic search imports successful
INFO:src.api.wazuh_fastmcp_server:OpenAI client for LM Studio available
INFO:src.api.wazuh_fastmcp_server:LM Studio client initialized: http://192.168.56.1:1234/v1
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda:0
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: all-MiniLM-L6-v2
INFO:src.api.wazuh_fastmcp_server:Semantic search model loaded: all-MiniLM-L6-v2
INFO:src.api.wazuh_fastmcp_server:Semantic search initialized successfully
============================================================
Traceback (most recent call last):
  File "C:\Users\risqu\Desktop\LMS MCP\src\telegram\telegram_security_bot.py", line 1151, in <module>
    print("\U0001f680 Telegram Security Bot Starting")
  File "C:\Users\risqu\AppData\Local\Programs\Python\Python310\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f680' in position 0: character maps to <undefined>
INFO:src.api.wazuh_fastmcp_server:CAG (transformers/torch) imports successful
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:src.api.wazuh_fastmcp_server:Semantic search imports successful
INFO:src.api.wazuh_fastmcp_server:OpenAI client for LM Studio available
INFO:src.api.wazuh_fastmcp_server:LM Studio client initialized: http://192.168.56.1:1234/v1
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda:0
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: all-MiniLM-L6-v2
INFO:src.api.wazuh_fastmcp_server:Semantic search model loaded: all-MiniLM-L6-v2
INFO:src.api.wazuh_fastmcp_server:Semantic search initialized successfully
============================================================
Traceback (most recent call last):
  File "C:\Users\risqu\Desktop\LMS MCP\src\telegram\telegram_security_bot.py", line 1151, in <module>
    print("\U0001f680 Telegram Security Bot Starting")
  File "C:\Users\risqu\AppData\Local\Programs\Python\Python310\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f680' in position 0: character maps to <undefined>
INFO:src.api.wazuh_fastmcp_server:CAG (transformers/torch) imports successful
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:src.api.wazuh_fastmcp_server:Semantic search imports successful
INFO:src.api.wazuh_fastmcp_server:OpenAI client for LM Studio available
INFO:src.api.wazuh_fastmcp_server:LM Studio client initialized: http://192.168.56.1:1234/v1
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda:0
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: all-MiniLM-L6-v2
INFO:src.api.wazuh_fastmcp_server:Semantic search model loaded: all-MiniLM-L6-v2
INFO:src.api.wazuh_fastmcp_server:Semantic search initialized successfully
INFO:src.api.wazuh_fastmcp_server:🔄 Building CAG knowledge cache from up to 1000 security logs (32K token optimized)...
INFO:src.api.wazuh_fastmcp_server:📊 Retrieved 64 security logs with ALL COLUMNS from database (RAM: 64GB optimized)
INFO:src.api.wazuh_fastmcp_server:📊 Processing 64 security logs for knowledge cache...
INFO:src.api.wazuh_fastmcp_server:🔄 Building vector embeddings for semantic search...
INFO:src.api.wazuh_fastmcp_server:🔄 Retrieving ALL security logs for embedding creation (64GB RAM optimized)...
INFO:src.api.wazuh_fastmcp_server:📊 Retrieved 64 security logs with ALL COLUMNS from database (RAM: 64GB optimized)
INFO:src.api.wazuh_fastmcp_server:📊 Creating embeddings for 64 security logs...
INFO:src.api.wazuh_fastmcp_server:🔄 Processing 64 logs in 1 batches of 10000...
INFO:src.api.wazuh_fastmcp_server:🔄 Processing batch 1/1 (64 logs)...
INFO:src.api.wazuh_fastmcp_server:Creating embeddings for batch 1: 64 logs...
🔄 Initializing Wazuh CAG (Cache-Augmented Generation) with security logs...
Batches:   0%|          | 0/2 [00:00<?, ?it/s]Batches:  50%|█████     | 1/2 [00:00<00:00,  7.07it/s]Batches: 100%|██████████| 2/2 [00:00<00:00, 10.88it/s]
INFO:src.api.wazuh_fastmcp_server:✅ Built and cached 64 vector embeddings (Total: 64 vectors)
INFO:src.api.wazuh_fastmcp_server:✅ Vector embeddings built successfully
INFO:src.api.wazuh_fastmcp_server:✅ CAG knowledge cache built with 64 security events
INFO:__main__:🚀 Starting Telegram Security Bot...
INFO:__main__:🚀 Initializing Telegram Security Bot...
INFO:src.api.mcp_tool_bridge:Connecting to FastMCP server...
INFO:src.api.mcp_tool_bridge:FastMCP client created successfully
INFO:src.telegram.telegram_report_generator:✅ MCP Bridge initialized for report generator
INFO:src.api.mcp_tool_bridge:Connecting to FastMCP server...
INFO:src.api.mcp_tool_bridge:FastMCP client created successfully
INFO:__main__:✅ Telegram Security Bot initialized successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/setMyCommands "HTTP/1.1 200 OK"
INFO:__main__:✅ Bot initialized successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getMe "HTTP/1.1 200 OK"
INFO:__main__:Bot Username: @wazoeh_bot
INFO:__main__:🔄 Starting polling...
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getMe "HTTP/1.1 200 OK"
INFO:apscheduler.scheduler:Scheduler started
INFO:telegram.ext.Application:Application started
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/deleteWebhook "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/answerCallbackQuery "HTTP/1.1 200 OK"
INFO:apscheduler.scheduler:Added job "realtime_alert_monitoring" to job store "default"
INFO:__main__:🚨 AGGRESSIVE realtime alert monitoring started (10s interval, rule level 5+, LATEST 5 ROWS ONLY)
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/editMessageText "HTTP/1.1 200 OK"
INFO:__main__:User 1033102340 enabled realtime alerts
INFO:__main__:🚨 Started realtime alert monitoring
INFO:__main__:🔄 Realtime alert monitoring started
INFO:__main__:🚨 Found 5 NEW UNIQUE events (rule level 5+, duplicates filtered)
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/sendMessage "HTTP/1.1 200 OK"
INFO:__main__:✅ Alert sent to user 1033102340
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:55:31 UTC)" (scheduled at 2025-09-21 13:55:21.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:55:31 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:__main__:=== PROCESSING MESSAGE FOR SESSION c926981c-efc6-462d-853d-8d34c6f83ca0 ===
INFO:__main__:Session has 0 messages
INFO:__main__:Available MCP tools: 58
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/sendChatAction "HTTP/1.1 200 OK"
INFO:__main__:Sending request to LM Studio: http://192.168.56.1:1234/v1
INFO:__main__:Model: qwen/qwen3-1.7b
INFO:httpx:HTTP Request: POST http://192.168.56.1:1234/v1/chat/completions "HTTP/1.1 200 OK"
INFO:__main__:LM Studio response received successfully
INFO:__main__:Processing 1 tool calls
INFO:__main__:Executing tool 1/1: check_wazuh_log
INFO:__main__:Executing tool: check_wazuh_log with args: {'query': 'siapakah anda?'}
INFO:src.api.mcp_tool_bridge:Executing tool: check_wazuh_log with args: {'query': 'siapakah anda?', 'max_results': 15, 'days_range': 7}
WARNING:apscheduler.executors.default:Run time of job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:55:41 UTC)" was missed by 0:00:03.639517
INFO:__main__:CAG (transformers/torch) imports successful
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:__main__:Semantic search imports successful
INFO:__main__:OpenAI client for LM Studio available
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:__main__:LM Studio client initialized: http://192.168.56.1:1234/v1
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda:0
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: all-MiniLM-L6-v2
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:55:51 UTC)" (scheduled at 2025-09-21 13:55:41.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:55:51 UTC)" executed successfully
INFO:__main__:Semantic search model loaded: all-MiniLM-L6-v2
INFO:__main__:Semantic search initialized successfully


+- FastMCP 2.0 --------------------------------------------------------------+
|                                                                            |
|        _ __ ___ ______           __  __  _____________    ____    ____     |
|       _ __ ___ / ____/___ ______/ /_/  |/  / ____/ __ \  |___ \  / __ \    |
|      _ __ ___ / /_  / __ `/ ___/ __/ /|_/ / /   / /_/ /  ___/ / / / / /    |
|     _ __ ___ / __/ / /_/ (__  ) /_/ /  / / /___/ ____/  /  __/_/ /_/ /     |
|    _ __ ___ /_/    \__,_/____/\__/_/  /_/\____/_/      /_____(_)____/      |
|                                                                            |
|                                                                            |
|                                                                            |
|    \U0001f5a5\ufe0f  Server name:     Wazuh AI Threat Hunting Server                      |
|    \U0001f4e6 Transport:       STDIO                                               |
|                                                                            |
|    \U0001f4da Docs:            https://gofastmcp.com                               |
|    \U0001f680 Deploy:          https://fastmcp.cloud                               |
|                                                                            |
|    \U0001f3ce\ufe0f  FastMCP version: 2.11.3                                              |
|    \U0001f91d MCP version:     1.13.0                                              |
|                                                                            |
+----------------------------------------------------------------------------+


[09/21/25 20:55:45] INFO     Starting MCP server 'Wazuh AI       server.py:1445
                             Threat Hunting Server' with                       
                             transport 'stdio'                                 
INFO:src.api.mcp_tool_bridge:Connected to MCP server, executing tool: check_wazuh_log
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:httpx:HTTP Request: POST http://192.168.56.1:1234/v1/chat/completions "HTTP/1.1 200 OK"
INFO:__main__:\U0001f504 Building CAG knowledge cache from up to 307 security logs (32K token optimized)...
INFO:__main__:\U0001f4ca Retrieved 64 security logs with ALL COLUMNS from database (RAM: 64GB optimized)
INFO:__main__:\U0001f4ca Processing 64 security logs for knowledge cache...
INFO:__main__:\U0001f504 Building vector embeddings for semantic search...
INFO:__main__:\U0001f504 Retrieving ALL security logs for embedding creation (64GB RAM optimized)...
INFO:__main__:\U0001f4ca Retrieved 64 security logs with ALL COLUMNS from database (RAM: 64GB optimized)
INFO:__main__:\U0001f4ca Creating embeddings for 64 security logs...
INFO:__main__:\U0001f504 Processing 64 logs in 1 batches of 10000...
INFO:__main__:\U0001f504 Processing batch 1/1 (64 logs)...
INFO:__main__:Creating embeddings for batch 1: 64 logs...
[09/21/25 20:55:48] INFO     Server log: 🔍 Memproses pertanyaan: logging.py:40
                             siapakah anda?                                    
Batches:   0%|          | 0/2 [00:00<?, ?it/s]Batches:  50%|#####     | 1/2 [00:00<00:00,  1.32it/s]Batches: 100%|##########| 2/2 [00:01<00:00,  1.49it/s]Batches: 100%|##########| 2/2 [00:01<00:00,  1.46it/s]
INFO:__main__:\u2705 Built and cached 64 vector embeddings (Total: 64 vectors)
INFO:__main__:\u2705 Vector embeddings built successfully
INFO:__main__:\u2705 CAG knowledge cache built with 64 security events
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:01 UTC)" (scheduled at 2025-09-21 13:55:51.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:01 UTC)" executed successfully
INFO:httpx:HTTP Request: POST http://192.168.56.1:1234/v1/chat/completions "HTTP/1.1 200 OK"
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 29.34it/s]
INFO:__main__:Semantic search found 15 results
[09/21/25 20:56:00] INFO     Server log: 🔍 Query RAG yang        logging.py:40
                             dihasilkan: <think>                               
                             Okay, the user is asking for optimal              
                             Wazuh log analysis search queries.                
                             They mentioned they're using an AI                
                             threat hunting system. Let me start               
                             by understanding their needs.                     
                                                                               
                             First, the question "siapakah anda?"              
                             is in Indonesian, so maybe they want              
                             to know how to find information                   
                             about Wazuh logs. But the main task               
                             is to create search queries for                   
                             analyzing security logs.                          
                                                                               
                             I need to consider keywords from the              
                             question. The key terms here are                  
                             "Wazuh," "log analysis," "security                
                             logs," and possibly "threat                       
                             hunting." Also, entities like                     
                             agents, rules, IPs, etc., are                     
                             important.                                        
                                                                               
                             The user wants focused and effective              
                             queries. So I should include common               
                             Wazuh components: agents, rules,                  
                             events, IP addresses, timestamps,                 
                             and maybe threat indicators like                  
                             suspicious activities or malware.                 
                                                                               
                             Possible search terms could be:                   
                             - "wazuh log analysis"                            
                             - "security logs wazuh"                           
                             - "threat hunting wazuh"                          
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:11 UTC)" (scheduled at 2025-09-21 13:56:01.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:11 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:21 UTC)" (scheduled at 2025-09-21 13:56:11.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:21 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:31 UTC)" (scheduled at 2025-09-21 13:56:21.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:31 UTC)" executed successfully
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:41 UTC)" (scheduled at 2025-09-21 13:56:31.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:41 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:51 UTC)" (scheduled at 2025-09-21 13:56:41.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:56:51 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:01 UTC)" (scheduled at 2025-09-21 13:56:51.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:01 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:11 UTC)" (scheduled at 2025-09-21 13:57:01.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:11 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:21 UTC)" (scheduled at 2025-09-21 13:57:11.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:21 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:31 UTC)" (scheduled at 2025-09-21 13:57:21.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:31 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:41 UTC)" (scheduled at 2025-09-21 13:57:31.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:41 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:51 UTC)" (scheduled at 2025-09-21 13:57:41.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:57:51 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:58:01 UTC)" (scheduled at 2025-09-21 13:57:51.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:58:01 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST http://192.168.56.1:1234/v1/chat/completions "HTTP/1.1 200 OK"
[09/21/25 20:58:00] INFO     Server log: 📤 Mengirim 15 logs ke   logging.py:40
                             LLM untuk analisis final                          
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:src.api.mcp_tool_bridge:Tool check_wazuh_log executed successfully
INFO:__main__:Tool check_wazuh_log executed successfully
INFO:__main__:Getting final response from LM Studio after tool execution...
INFO:httpx:HTTP Request: POST http://192.168.56.1:1234/v1/chat/completions "HTTP/1.1 200 OK"
INFO:__main__:Final response received from LM Studio
INFO:__main__:Saving assistant message to database...
INFO:__main__:Message saved to database successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
WARNING:apscheduler.executors.default:Run time of job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:58:31 UTC)" was missed by 0:00:02.308012
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/sendMessage "HTTP/1.1 200 OK"
INFO:__main__:Chat processing complete. Response length: 3251 characters
INFO:__main__:✅ Question answered for user 1033102340
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:58:41 UTC)" (scheduled at 2025-09-21 13:58:31.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:58:41 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:58:51 UTC)" (scheduled at 2025-09-21 13:58:41.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:58:51 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:01 UTC)" (scheduled at 2025-09-21 13:58:51.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:01 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:11 UTC)" (scheduled at 2025-09-21 13:59:01.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:11 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:21 UTC)" (scheduled at 2025-09-21 13:59:11.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:21 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:31 UTC)" (scheduled at 2025-09-21 13:59:21.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:31 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:41 UTC)" (scheduled at 2025-09-21 13:59:31.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:41 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:51 UTC)" (scheduled at 2025-09-21 13:59:41.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 13:59:51 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:01 UTC)" (scheduled at 2025-09-21 13:59:51.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:01 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:11 UTC)" (scheduled at 2025-09-21 14:00:01.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:11 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:21 UTC)" (scheduled at 2025-09-21 14:00:11.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:21 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:31 UTC)" (scheduled at 2025-09-21 14:00:21.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:31 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:41 UTC)" (scheduled at 2025-09-21 14:00:31.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:41 UTC)" executed successfully
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot8289779353:AAG5TLJJP8JjwUJzQXMILAOG-7ufQA9ueM8/getUpdates "HTTP/1.1 200 OK"
INFO:apscheduler.executors.default:Running job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:51 UTC)" (scheduled at 2025-09-21 14:00:41.654362+00:00)
INFO:apscheduler.executors.default:Job "realtime_alert_monitoring (trigger: interval[0:00:10], next run at: 2025-09-21 14:00:51 UTC)" executed successfully
